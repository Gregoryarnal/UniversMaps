<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniversMaps</title>
    <link rel="stylesheet" type="text/css" href="style.css">

      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
  <script>
	  var httpRequest
	  var planet
	  function makeRequest(name) {
	    httpRequest = new XMLHttpRequest();
	    if (!httpRequest) {
	      alert('Abandon :( Impossible de créer une instance de XMLHTTP');
	      return false;
	    }
	    planet = name;
	    httpRequest.onreadystatechange = alertContents;
	    httpRequest.open('GET', '/popup/'+ name);
	    httpRequest.send();
	   
	  }

	  function alertContents() {
		  if (httpRequest.readyState === XMLHttpRequest.DONE) {
	  	      if (httpRequest.status === 200) {
	  	    	document.getElementById("data"+planet).innerHTML = httpRequest.responseText;
	  	      } else {
	  	        alert('Il y a eu un problème avec la requête.');
	  	      }
	  	    }
	  }
	  

  </script>
  

</head>

<header class="page-header">
    <h1>Cute Puppies Express!</h1>
</header>
<body>

<div class="container">

  <!-- Trigger the modal with a img -->
  <div th:each="planet : ${planets}">
   <div th:class="${planet.name+'-path'}"></div>
	  <a th:class="${planet.name}"  th:attr="onclick=|makeRequest('${planet.name}')|"  data-toggle="modal" th:data-target="${'#'+planet.name+'modal'}">
			<img th:id="${planet.name}"  th:src="@{'/photos/' + ${planet.name} + '.png'}" th:alt="${planet.name}"/>
		</a>
		
		  <!-- Modal -->
	  <div class="modal fade" th:id="${planet.name+'modal'}" role="dialog">
	    <div class="modal-dialog">
	    
	      <!-- Modal content-->
	      <div class="modal-content">
	        <div class="modal-header">
	          <button type="button" class="close" data-dismiss="modal">&times;</button>
	          <h4 class="modal-title" th:text="${planet.name}"></h4>
	        </div>
	        <div th:id="${'data'+planet.name}" class="modal-body">
	          <p>Chargement des données.</p>
	        </div>
	        <div class="modal-footer">
	          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        </div>
	      </div>
	      
	    </div>
	  </div>
		
  </div>
	
	

  
</div>

</body>
</html>